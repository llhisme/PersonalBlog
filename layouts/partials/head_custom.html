<!--
If you want to include any custom html just before </head>, put it in this file.
Or you can delete these file if you don't need it.
-->
<!-- for example, you could insert this custom css, which makes the bigimg not stretch:
<style>
.intro-header.big-img, .intro-header.big-img  .big-img-transition {
  -webkit-background-size: contain !important;
  -moz-background-size: contain !important;
  background-size: contain !important;
  -o-background-size: contain !important;
  background-color: lightgrey;
}
</style>
-->
<!-- or you could include some additional css libraries:
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/vis/4.19.1/vis.css" integrity="sha256-I1UoFd33KHIydu88R9owFaQWzwkiZV4hXXug5aYaM28=" crossorigin="anonymous" />
-->
<style>
  /* 1. Tắt chế độ tự động của theme */
  @media (prefers-color-scheme: dark) {
    body {
      filter: none !important;
    }
    img, .highlight, .navbar, .img-logo, pre, code {
      filter: none !important;
    }
  }

  /* 2. Định nghĩa lớp .user-dark-mode của riêng ta */
  /* Đây là lớp mà JavaScript sẽ bật/tắt */
  body.user-dark-mode {
    background-color: #2b2b2b; /* Thêm màu nền tối */
    filter: invert(1);
  }
  
  /* 3. Đảo ngược lại các thành phần bị ảnh hưởng bởi filter */
  body.user-dark-mode img,
  body.user-dark-mode .highlight,
  body.user-dark-mode .navbar,
  body.user-dark-mode .img-logo,
  body.user-dark-mode pre,
  body.user-dark-mode code,
  body.user-dark-mode #theme-toggle-button { /* Đảo ngược cả nút bấm */
    filter: invert(1);
  }

  /* 4. Tinh chỉnh lại màu sắc cho dễ đọc hơn trong dark-mode */
  body.user-dark-mode .navbar {
    background-color: #f5f5f5; /* Màu nền navbar khi bị đảo ngược */
  }
  body.user-dark-mode a {
    color: #428bca; /* Giữ màu link xanh */
  }

  /* 5. CSS cho nút bấm Toggle */
  #theme-toggle-button {
    position: fixed;
    bottom: 15px;
    right: 15px;
    width: 50px;
    height: 50px;
    border-radius: 50%;
    background: #fff;
    color: #333;
    border: 1px solid #ddd;
    box-shadow: 0 2px 5px rgba(0,0,0,0.2);
    font-size: 24px;
    cursor: pointer;
    z-index: 999;
    /* Căn giữa icon */
    display: flex;
    align-items: center;
    justify-content: center;
    transition: background 0.3s, color 0.3s;
  }
</style>

<script>
  // Chạy script sau khi trang đã tải xong
  document.addEventListener('DOMContentLoaded', function() {
    
    var body = document.body;
    var storageKey = 'theme-preference';
    
    // 1. Tạo nút bấm bằng JavaScript
    var button = document.createElement('button');
    button.id = 'theme-toggle-button';
    // Thêm nút bấm vào cuối trang
    document.body.appendChild(button);

    // 2. Hàm để áp dụng theme
    function applyTheme(theme) {
      if (theme === 'dark') {
        body.classList.add('user-dark-mode');
        button.innerHTML = '☀️'; // Icon mặt trời
        localStorage.setItem(storageKey, 'dark');
      } else {
        body.classList.remove('user-dark-mode');
        button.innerHTML = '🌙'; // Icon mặt trăng
        localStorage.setItem(storageKey, 'light');
      }
    }

    // 3. Lấy theme đã lưu từ localStorage (hoặc mặc định là 'light')
    var savedTheme = localStorage.getItem(storageKey) || 'light';
    
    // 4. Áp dụng theme khi tải trang
    applyTheme(savedTheme);

    // 5. Thêm sự kiện click cho nút bấm
    button.addEventListener('click', function() {
      // Kiểm tra xem hiện tại đang là theme gì
      var currentTheme = body.classList.contains('user-dark-mode') ? 'dark' : 'light';
      // Chuyển đổi theme
      var newTheme = currentTheme === 'dark' ? 'light' : 'dark';
      applyTheme(newTheme);
    });

  });
</script>